---
description: Storybook 스토리 작성 및 컴포넌트 문서화 가이드라인
globs: **/*.stories.{ts,tsx}, src/stories/**/*, src/**/*.stories.{ts,tsx}
alwaysApply: false
---

- **Storybook 스토리 파일 구조**
  - 스토리 파일은 컴포넌트와 같은 디렉토리에 위치하거나 `src/stories/` 디렉토리에 배치
  - 파일명은 `[ComponentName].stories.ts` 또는 `[ComponentName].stories.tsx` 형식 사용 (PascalCase)
  - 컴포넌트 파일명도 PascalCase 사용 ([Button.tsx](mdc:src/shared/shadcn/Button.tsx))

- **스토리 파일 기본 구조**

  ```typescript
  import type { Meta, StoryObj } from '@storybook/nextjs-vite';
  import { fn } from 'storybook/test';

  import { ComponentName } from './ComponentName';

  const meta = {
    title: 'Category/ComponentName',
    component: ComponentName,
    parameters: {
      layout: 'centered', // 또는 'fullscreen', 'padded'
    },
    tags: ['autodocs'],
    argTypes: {
      // 컨트롤 설정
    },
    args: {
      // 기본 args
    },
  } satisfies Meta<typeof ComponentName>;

  export default meta;
  type Story = StoryObj<typeof meta>;

  export const Default: Story = {
    args: {
      // 스토리별 args
    },
  };
  ```

- **Meta 설정 규칙**
  - `title`: `'Category/ComponentName'` 형식 사용 (예: `'UI/Button'`, `'Features/ImageUploader'`)
  - `component`: 실제 컴포넌트 import
  - `parameters.layout`: 컴포넌트 크기에 따라 `'centered'`, `'fullscreen'`, `'padded'` 선택
  - `tags: ['autodocs']`: 자동 문서 생성 활성화
  - `satisfies Meta<typeof Component>`: 타입 안전성 보장

- **argTypes 설정**
  - 컨트롤 타입 명시: `control: 'color'`, `control: 'select'`, `control: 'boolean'` 등
  - 옵션 제한: `options: ['option1', 'option2']` 사용
  - 설명 추가: `description: '컴포넌트 설명'`

  ```typescript
  // ✅ DO: 명확한 argTypes 설정
  argTypes: {
    variant: {
      control: 'select',
      options: ['default', 'destructive', 'outline'],
      description: '버튼 스타일 변형',
    },
    size: {
      control: 'select',
      options: ['sm', 'default', 'lg'],
    },
  },

  // ❌ DON'T: argTypes 누락
  argTypes: {},
  ```

- **이벤트 핸들러 처리**
  - `storybook/test`의 `fn()` 사용하여 이벤트 핸들러 스파이 생성
  - Actions 패널에서 이벤트 호출 확인 가능

  ```typescript
  import { fn } from 'storybook/test';

  const meta = {
    args: {
      onClick: fn(),
      onSubmit: fn(),
    },
  };
  ```

- **스토리 작성 규칙**
  - 각 스토리는 `Story` 타입으로 export
  - 스토리명은 PascalCase 사용 (예: `Default`, `Primary`, `WithIcon`)
  - 의미 있는 이름 사용: 상태나 변형을 나타내는 이름 (예: `LoggedIn`, `LoggedOut`, `Disabled`)

  ```typescript
  // ✅ DO: 의미 있는 스토리명
  export const Default: Story = {
    args: {
      variant: 'default',
    },
  };

  export const Destructive: Story = {
    args: {
      variant: 'destructive',
    },
  };

  export const Disabled: Story = {
    args: {
      disabled: true,
    },
  };

  // ❌ DON'T: 모호한 스토리명
  export const Story1: Story = {};
  export const Test: Story = {};
  ```

- **인터랙션 테스트**
  - 정말 필요한 테스트만 작성: 모든 컴포넌트에 인터랙션 테스트를 추가하지 않음
  - 복잡한 상태 변화나 사용자 플로우가 있는 컴포넌트에만 적용
  - `storybook/test`의 `expect`, `userEvent`, `within` 사용
  - `play` 함수로 사용자 인터랙션 시뮬레이션

  ```typescript
  // ✅ DO: 복잡한 상태 변화가 있는 컴포넌트에만 사용
  import { expect, userEvent, within } from 'storybook/test';

  export const Interactive: Story = {
    play: async ({ canvasElement }) => {
      const canvas = within(canvasElement);
      const button = canvas.getByRole('button', { name: /click me/i });
      await expect(button).toBeInTheDocument();
      await userEvent.click(button);
      // 상태 변화 검증
    },
  };

  // ❌ DON'T: 단순한 버튼이나 정적 컴포넌트에 불필요한 인터랙션 테스트 추가
  export const SimpleButton: Story = {
    // play 함수 없이도 충분함
    args: {
      label: 'Click me',
    },
  };
  ```

- **컴포넌트 Props 문서화**
  - JSDoc 주석으로 컴포넌트와 props 설명
  - `/** */` 형식 사용

  ```typescript
  /**
   * 버튼 컴포넌트
   * 다양한 variant와 size를 지원하는 재사용 가능한 버튼
   */
  export interface ButtonProps {
    /** 버튼 스타일 변형 */
    variant?: 'default' | 'destructive' | 'outline';
    /** 버튼 크기 */
    size?: 'sm' | 'default' | 'lg';
    /** 비활성화 여부 */
    disabled?: boolean;
  }
  ```

- **Import 경로 규칙**
  - 상대 경로 사용: 같은 디렉토리의 컴포넌트는 `'./ComponentName'`
  - 절대 경로 사용: 다른 디렉토리는 `@/` alias 사용

  ```typescript
  // ✅ DO: 같은 디렉토리
  import { Button } from './Button';

  // ✅ DO: 다른 디렉토리
  import { Button } from '@/shared/shadcn/Button';

  // ❌ DON'T: 일관성 없는 경로
  import { Button } from '../../../shared/shadcn/Button';
  ```

- **스토리 파일 위치**
  - 컴포넌트와 같은 디렉토리: `src/shared/shadcn/Button.stories.tsx`
  - 또는 `src/stories/` 디렉토리: `src/stories/Button.stories.ts`
  - 프로젝트 구조에 따라 일관성 유지

- **참고 예시**
  - [Button.stories.ts](mdc:src/stories/Button.stories.ts) - 기본 스토리 구조
  - [Header.stories.ts](mdc:src/stories/Header.stories.ts) - 복잡한 컴포넌트 스토리
  - [Page.stories.ts](mdc:src/stories/Page.stories.ts) - 인터랙션 테스트 포함
